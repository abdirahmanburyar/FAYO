generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["multiSchema"]
  binaryTargets   = ["native", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["call"]
}

model CallSession {
  id           String     @id @default(cuid())
  channelName  String     @unique
  callType     CallType   @default(VIDEO)
  initiatorId  String
  recipientId  String?
  status       CallStatus @default(PENDING)
  expiresAt    DateTime
  startedAt    DateTime?
  endedAt      DateTime?
  metadata     Json?
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt

  @@map("call_sessions")
  @@schema("call")
  @@index([initiatorId], map: "call_sessions_initiator_idx")
  @@index([recipientId], map: "call_sessions_recipient_idx")
}

enum CallStatus {
  PENDING
  RINGING
  ACTIVE
  COMPLETED
  CANCELLED
  EXPIRED

  @@schema("call")
}

enum CallType {
  VIDEO
  VOICE

  @@schema("call")
}

